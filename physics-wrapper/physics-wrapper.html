<!-- Import Polymer -->
<link rel="import" href="../../bower_components/polymer/polymer.html">

<!-- Define your custom element -->
<polymer-element name="physics-wrapper" attributes="loc vel mass acc">
    <template>
        <style>
            :host{
                position:absolute;
            };
        </style>
        <content></content>
    </template>

    <script>
        Polymer({
            created: function() {
                this.loc = {x: Math.random()*window.innerWidth * 0.8 + 100, y: Math.random()*300};
                this.vel = {dx: 0, dy: 0};
                this.acc = {ddx: 0, ddy: 0};
                this.mass = 1;
                this.setAttributes();
            },
            
            setAttributes: function() {
                this.setAttribute("locx", this.loc.x);
                this.setAttribute("locy", this.loc.y);

                this.setAttribute("velx", this.vel.dx);
                this.setAttribute("vely", this.vel.dy);
                
                this.setAttribute("accx", this.acc.ddx);
                this.setAttribute("accy", this.acc.ddy);
                
                this.setAttribute("mass", this.mass);
            },

            accelerate: function(ddx, ddy) {
                this.acc.ddx += ddx;
                this.acc.ddy += ddy + Math.random() * 20 - 10;
            },

            setBounds: function(xmin, xmax, ymin, ymax) {
                console.log(xmax);
            },

            // Estimates the new location based on 1 iteration of Euler's method
            advanceState: function(dt) {
                if (this.loc.y < window.innerHeight - 100 && this.loc.y > 0 && this.loc.x > 0 && this.loc.x < window.innerWidth) {
                    this.vel.dx += dt * this.acc.ddx;
                    this.vel.dy += dt * this.acc.ddy;

                    this.loc.x += dt * this.vel.dx;
                    this.loc.y += dt * this.vel.dy;

                    this.updateState();
                }
            },

            // Modifies the DOM to follow the attributes
            updateState: function () {
                $(this).css({top:this.loc.y, left:this.loc.x});

            }
        });
    </script>

</polymer-element>

